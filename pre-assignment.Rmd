---
title: "pre-assignment"
author: "Jakub Skrajny"
date: "27 04 2021"
output:
  pdf_document: default
  html_document: default
---
# Libraries
```{r}
library(openxlsx)
library(tseries)
library(forecast)
library(EnvStats)
```

# Read data (date = number of days from 1900)
```{r cars}
data <- read.xlsx("Lions_Den_data.xlsx")
timeseries <- unlist(data[2])
```

# Decomposition
```{r}
ts <- ts(timeseries, frequency = 12)
decompose <- decompose(ts, "additive")
plot(decompose)
```

# Outliers
Rosner's test suggest that there is only one outlier.
```{r}
hist(timeseries,
  xlab = "coal usage",
)
test <- rosnerTest(timeseries,
  k = 3
)
test
```

# Autocorrelation and stationarity analysis
We can see that time-series is already stationary.
```{r}
x <- timeseries
#autocorrelation
acf(x, lag.max = 12)
#stationary test
adf.test(x)
```

# Transform time series
Remove seasonal trend and linear trend by using differentiation with lag=12 and decompose result.
```{r}
x <- diff(timeseries, lag=12, difference=2)
plot(x, type="s")
#autocorrelation
acf(x, lag.max = 12)
#stationary test
print(adf.test(x))
ts <- ts(x, frequency = 12)
decompose = decompose(ts, "multiplicative")
plot(decompose)
```
```